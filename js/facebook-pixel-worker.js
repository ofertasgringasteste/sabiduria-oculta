var otButtonCheckoutWorker='.bettercart_checkout,[name^="checkout"],[name^="checkout"] .loader-button__text,.shopify-payment-button__button,.btn-checkout,a.fbq-checkout,.checkout_btn,.OTCheckout,.OTCheckout span,#cart .action_button.right, shop-pay-wallet-button, shop-pay-wallet-button button, shop-pay-wallet-button slot';function otDetectPixels(t){console.log("%c Omega Facebook pixels: Event tracking using the Web worker codebase","color: black; background: #EFDCCC;padding: 5px; border-radius: 5px");let e={...OT_DATA_CUSTOMER__TRACK_FB};""!=ot_ip&&(e={...e,client_ip_address:ot_ip}),"FREE"==omegaFBSettings?.settings?.plan_configs?.plan_type&&omegaFBSettings?.settings?.plan_configs?.order_remain<=0||t.forEach(t=>{fbq("init",t,e)})}async function otHandleCheckWorkingPage(){return!await otDisagreeForTracking()&&"undefined"!=typeof omegaFBSettings&&void 0!==omegaFBSettings.settings.is_enable_web_pixel&&"0"!=omegaFBSettings.settings.is_enable_web_pixel&&"1"==omegaFBSettings.settings.enable}localStorage.removeItem("ot_tracking_ic_shop_pay"),(async()=>{await otHandleCheckWorkingPage()&&otMultiFacebookPixelWorker({},omegaFBSettings.settings)})();var debounceTimeout=null;async function otTrackViewContentWorker(o){var n="1"==omegaFBSettings?.settings?.content_type_event?"product":"product_group";if("undefined"!=typeof arrayFBPixelTrack&&0<arrayFBPixelTrack.length&&-1<fb_pageURL.indexOf("/products/")){i=-1<fb_pageURL.indexOf("?")?(i=fb_pageURL.split("?"))[0]+".json":fb_pageURL+".json";var i=await otGetInfoProductByLink(i);-1<i.title.indexOf("'")&&(i.title=i.title.replace(/'/g,""));let e=ot_getUrlParam("variant"),t=e?""+e:""+meta.product.variants[0].id,a=("product_group"==n&&(t=void 0!==i.id?""+i.id:""+meta.product.id),i.variants[0].price);null!=e&&meta.product.variants.forEach(t=>{t.id==e&&(a=parseInt(t.price)/100)}),otCheckEnableTracking("pixel_track_viewcontent")&&fbq("track","ViewContent",{content_ids:[t],content_type:n,value:a,content_name:i.title,currency:Shopify.currency.active},{eventID:o}),!otCheckEnableTracking("capi_track_viewcontent")||"FREE"==omegaFBSettings?.settings?.plan_configs?.plan_type&&omegaFBSettings?.settings?.plan_configs?.order_remain<=0||trackEventFBConversionAPI({},{action:"ViewContent",event_id:o,event_source_url:fb_pageURL,content_ids:[t],content_type:n,value:a,content_name:i.title,currency:Shopify.currency.active,pixels:arrayFBPixelTrack,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}}setTimeout(()=>{new MutationObserver(function(t){t.forEach(function(t){debounceTimeout&&clearTimeout(debounceTimeout),debounceTimeout=setTimeout(async()=>{var t,e=await otHandleCheckWorkingPage();null!=localStorage.getItem("OT_DATA_TRIGGER_ATC_NEW_TRIGGER")?e?(t=JSON.parse(localStorage.getItem("OT_DATA_TRIGGER_ATC_NEW_TRIGGER")),omegaCallBackAddToCartTrigger(t)):localStorage.removeItem("OT_DATA_TRIGGER_ATC_NEW_TRIGGER"):e&&checkAddToCartEvent(),debounceTimeout=null},500)})}).observe(document.documentElement,{attributes:!0,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!0,characterDataOldValue:!0})},1e3);const LIST_SHOP_FIRE_VIEW_CONTENT_VARIANT_CHANGES=["thuyet-tester-2.myshopify.com","long-testapp.myshopify.com","twoowls-store.myshopify.com"];if(LIST_SHOP_FIRE_VIEW_CONTENT_VARIANT_CHANGES.includes(Shopify.shop)){let e=ot_getUrlParam("variant");const t=new MutationObserver(()=>{requestAnimationFrame(()=>{var t=ot_getUrlParam("variant");t&&t!==e&&(e=t,otTrackViewContentWorker(generateEventID(36)))})});t.observe(document.body,{childList:!0,subtree:!0})}function checkAddToCartEvent(){var r={};getItemOnCartPageFB(function(t){var e=localStorage.getItem("item_count");localStorage.setItem("OTPXADDED",1),e!=t.item_count&&window.localStorage.setItem("item_count",t.item_count);let i="1"==omegaFBSettings.settings.content_type_event?"product":"product_group";if(0<t.items.length&&"shipping-protection"!=t.items[0].handle&&e<t.item_count){let a=t.items[0],o=(localStorage.setItem("OTPXADDED",0),localStorage.setItem("item_count",t.item_count),""+a.variant_id),n=("product_group"==i&&(o=""+a.product_id),generateEventID(36));otCheckEnableTracking("pixel_track_addtocart")&&arrayFBPixelTrack.forEach(function(t,e){otfbq(""+t,"AddToCart",{content_ids:o,content_type:i,value:parseInt(a.price)/100,content_name:a.product_title,currency:Shopify.currency.active},n)}),otCheckEnableTracking("capi_track_addtocart")&&(e=detectLastInfoATCByProductId(a.product_id,t.items),trackEventFBConversionAPI(r,{action:"AddToCart",event_id:n,event_source_url:fb_pageURL,content_ids:o,content_type:i,value:parseInt(a.price)/100,content_name:a.product_title,currency:Shopify.currency.active,pixels:arrayFBPixelTrack,shop:Shopify.shop,products:e,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign}))}})}async function otMultiFacebookPixelWorker(t,e){let o="1"==e.content_type_event?"product":"product_group";if("undefined"!=typeof arrayFBPixelTrack&&0<arrayFBPixelTrack.length){if(otDetectPixels(arrayFBPixelTrack),-1==fb_pageURL.indexOf("/products/")&&"1"!=e.is_enable_trigger&&(n=generateEventID(36),otCheckEnableTracking("pixel_track_pageview")&&fbq("track","PageView",{},{eventID:n}),!otCheckEnableTracking("capi_track_pageview")||"FREE"==omegaFBSettings?.settings?.plan_configs?.plan_type&&omegaFBSettings?.settings?.plan_configs?.order_remain<=0||trackEventFBConversionAPI(t,{action:"PageView",event_id:n,event_source_url:fb_pageURL,pixels:arrayFBPixelTrack,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})),-1<fb_pageURL.indexOf("/products/")){i=-1<fb_pageURL.indexOf("?")?(i=fb_pageURL.split("?"))[0]+".json":fb_pageURL+".json";var n=await otGetInfoProductByLink(i),i=(-1<n.title.indexOf("'")&&(n.title=n.title.replace(/'/g,"")),generateEventID(36));let e=ot_getUrlParam("variant");e??meta.product.variants[0].id;"product_group"==o&&(void 0!==n.id?n:meta.product).id;n.variants[0].price;let a;null!=e&&meta.product.variants.forEach(t=>{t.id==e&&(a=parseInt(t.price)/100)}),otCheckEnableTracking("pixel_track_pageview")&&fbq("track","PageView",{},{eventID:i}),otTrackViewContentWorker(i)}-1<fb_pageURL.indexOf("/search")&&(n=generateEventID(36),otCheckEnableTracking("pixel_track_search")&&fbq("track","Search",{search_string:ot_getUrlParam("q")||""},{eventID:n}),otCheckEnableTracking("capi_track_search"))&&trackEventFBConversionAPI(t,{action:"Search",event_id:n,search_string:ot_getUrlParam("q")||"",event_source_url:fb_pageURL,pixels:arrayFBPixelTrack,shop:Shopify.shop,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign}),"1"!=e.is_enable_trigger&&document.addEventListener("click",function(t){(otEventClickIsMatchesDom(t,(2!=e.is_enable_web_pixel||!window?.ShopifyPay)&&2==e.is_enable_web_pixel?"ot_pixel_detect-sample":otButtonCheckoutWorker,otListAllCustomCheckout)||t.target.matches("shopify-google-pay-button, shopify-paypal-button, shopify-apple-pay-button"))&&otTrackICWorker(arrayFBPixelTrack,e,o)})}}function otTrackICWorker(t,e,n){var i={},r=JSON.parse(localStorage.getItem("ot_cart"));if(0<r?.items?.length){let e=[],a=[],o=[];r.items.forEach(function(t){e.push("product_group"==n?""+t.product_id:""+t.variant_id),a.push(t.product_title),o.push({id:t.product_id,title:t.product_title})});var c=generateEventID(36);otCheckEnableTracking("pixel_track_checkout")&&fbq("track","InitiateCheckout",{content_type:n,content_ids:e,currency:Shopify.currency.active,value:parseFloat(r.total_price)/100,num_items:r.item_count,content_name:a},{eventID:c}),otCheckEnableTracking("capi_track_checkout")&&trackEventFBConversionAPIByBeacon(i,{action:"InitiateCheckout",event_id:c,event_source_url:fb_pageURL,content_ids:e,content_type:n,num_items:r.item_count,value:parseFloat(r.total_price)/100,content_name:a,currency:Shopify.currency.active,pixels:t,shop:Shopify.shop,products:o,obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}else if(void 0!==meta.product){let e=generateEventID(36);otCheckEnableTracking("pixel_track_checkout")&&t.forEach(function(t){otfbq(""+t,"InitiateCheckout",{content_type:n,content_ids:"product_group"==n?""+meta.product.id:""+meta.product.variants[0].id,currency:Shopify.currency.active,value:meta.product.variants[0].price,num_items:1,content_name:meta.product.variants[0].name},e)}),otCheckEnableTracking("capi_track_checkout")&&trackEventFBConversionAPIByBeacon(i,{action:"InitiateCheckout",event_id:e,event_source_url:fb_pageURL,content_ids:"product_group"==n?""+meta.product.id:""+meta.product.variants[0].id,content_type:n,num_items:1,value:meta.product.variants[0].price,content_name:meta.product.variants[0].name,currency:Shopify.currency.active,pixels:t,shop:Shopify.shop,products:[{id:meta.product.id,title:meta.product.variants[0].name}],obj_fbp_fbc:otGetAttributeFBCAndFBP(),...OT_DATA_CUSTOMER,...ot_information_campaign})}window?.ShopifyPay&&localStorage.setItem("ot_tracking_ic_shop_pay","true")}